import{d as z,c as _,r as S,e as d,f as p,u as i,F as w,h as A,j as E,k as h,l as I,m as G}from"./vue-89324afd.js";import{u as N,a as D,b as B}from"./vueuse-8c54e47c.js";import{T as U,A as H,P as M,a as F}from"./pixijs-1b94e22e.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function u(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=u(t);fetch(t.href,o)}})();function K(e,n,u){var o;e.interactive=!0;const s=n.slice(2).toLowerCase(),t=(o=e._vei??(e._vei={}))[n]??(o[n]=V(e,s,u));u?t.value=u:e.off(s,t)}function V(e,n,u){const s=()=>s.value();return s.value=u,e.on(n,s),s}const X={zIndex:1},q=["drawRect","alpha"],W=p("Text",{text:"🐍 SNAKE",x:12,"style:lineHeight":55,"style:fill":"white"},null,-1),Y=["texture"],$=["x","lineTo"],J=["y","lineTo"],Q=["x","y","style:fontSize","style:lineHeight"],Z=["x","y","drawRect"],j=["x","y"],ee=["x","y"],te=z({__name:"App",setup(e){const{width:u,height:s}=N(),t=_(()=>Math.min(u.value,s.value)/10),o=_(()=>u.value/t.value>>0),l=_(()=>s.value/t.value>>0),m=S([[2,5],[1,5],[0,5]]),v=S(L());let c="ArrowRight",b=c;window.addEventListener("keydown",r=>{if(r.key==" ")return R.value?x():O();["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(r.key)&&(c=="ArrowUp"&&r.key=="ArrowDown"||c=="ArrowDown"&&r.key=="ArrowUp"||c=="ArrowLeft"&&r.key=="ArrowRight"||c=="ArrowRight"&&r.key=="ArrowLeft"||(b=r.key))});const{resume:O,pause:x,isActive:R}=D(()=>{c=b;const r=m.value[0];let a;if(c=="ArrowUp"&&(a=[r[0],r[1]-1]),c=="ArrowDown"&&(a=[r[0],r[1]+1]),c=="ArrowLeft"&&(a=[r[0]-1,r[1]]),c=="ArrowRight"&&(a=[r[0]+1,r[1]]),!k(a))return x(),alert("撞墙身亡，游戏结束");if(m.value.slice(0,-1).some(f=>y(f,a)))return x(),alert("咬到自己，游戏结束");m.value.unshift(a),y(a,v.value)?v.value=L():m.value.pop()},250);function P(){const r=document.createElement("a");r.href="https://github.com/huodoushigemi/vue-canvas-snake.git",r.target="_blank",r.click()}function y(r,a){return r[0]==a[0]&&r[1]==a[1]}function k(r){return r[0]>=0&&r[0]<o.value&&r[1]>=0&&r[1]<l.value}function C(r,a=0){return a+Math.random()*(r-a)>>0}function L(){let r;do r=[C(o.value),C(l.value)];while(m.value.some(a=>y(a,r)));return r}return(r,a)=>(h(),d(w,null,[p("Graphics",X,[p("Graphics",{beginFill:[2962235],drawRect:[0,0,i(u),55],endFill:"",alpha:.75},null,8,q),W,p("Sprite",{texture:i(U).from("https://huodoushigemi.github.io/docx2vue/assets/github-540f5a2f.svg"),x:256,y:5,width:45,height:45,cursor:"pointer",onClick:P},null,8,Y)]),(h(!0),d(w,null,A(i(o),f=>(h(),d("Graphics",{x:f*i(t),lineStyle:[1],moveTo:[0,0],lineTo:[0,i(l)*i(t)]},null,8,$))),256)),(h(!0),d(w,null,A(i(l),f=>(h(),d("Graphics",{y:f*i(t),lineStyle:[1],moveTo:[0,0],lineTo:[i(o)*i(t),0]},null,8,J))),256)),p("Text",{text:"🍔",x:v.value[0]*i(t),y:v.value[1]*i(t),"style:fontSize":i(t)/1.4,"style:lineHeight":i(t)},null,8,Q),(h(!0),d(w,null,A(m.value,f=>(h(),d("Graphics",{x:f[0]*i(t),y:f[1]*i(t),beginFill:[0],drawRect:[0,0,i(t),i(t)],endFill:""},null,8,Z))),256)),p("Text",{text:"按空格 暂停/继续",x:i(o)*i(t)*.45,y:i(l)*i(t)*.8,"style:fill":3435973760},null,8,j),i(R)?E("",!0):(h(),d("Text",{key:0,text:"暂停中……",x:i(o)*i(t)*.45,y:i(l)*i(t)*.85,"style:fill":3435973760},null,8,ee))],64))}});function re(e,n,u,s="."){const t=n.split(s);return e=t.slice(0,-1).reduce((o,l)=>o[l]??(o[l]={}),e),e[t.at(-1)]=u}const g=new H({backgroundColor:"#242424"});g.stage.sortableChildren=!0;const T=g.view;T.id="canvas";document.body.appendChild(T);B(T,([e])=>{g.renderer.resize(e.contentRect.width,e.contentRect.height)});const ne=I({createElement(e,n,u,s){return new M[e]},insert(e,n,u){if(!e||!n)return;const s=n.children.indexOf(u);s>-1?n.addChildAt(e,s):n.addChild(e)},remove(e){e==null||e.removeFromParent()},patchProp(e,n,u,s){e&&(typeof e[n]=="function"?e[n](...s):G(n)?K(e,n,s):re(e,n,s,":"))},createText(e){return new F(e)},createComment(e){const n=new F(`<!-- ${e} -->`);return n.visible=!1,n},setText(e,n){e.text=n},setElementText(){},parentNode(e){return e==null?void 0:e.parent},nextSibling(e){return e==null?void 0:e.parent.children[e.parent.getChildIndex(e)+1]}});ne.createApp(te).mount(g.stage);
